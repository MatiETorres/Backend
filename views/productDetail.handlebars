<h2>{{product.title}}</h2>
<p>{{product.description}}</p>
<p>Precio: ${{product.price}}</p>
<p>Categoria: {{product.category}}</p>
<button onclick="addToCart('{{product._id}}')">Agregar al carrito</button>
<script>
async function addToCart(pid){
  let cartId = localStorage.getItem('cartId');
  if(!cartId){
    const res = await fetch('/api/carts', { method: 'POST' });
    const data = await res.json();
    cartId = data._id || data.id;
    localStorage.setItem('cartId', cartId);
  }
  await fetch(`/api/carts/${cartId}/product/${pid}`, { method: 'POST' });
  alert('Agregado al carrito');
}
</script>
